{
  "version": 1,
  "display": {
    "autoRotate": false,
    "showAxes": false,
    "showSurface": true,
    "showWireframe": false,
    "dirIntensity": 1,
    "shininess": 100
  },
  "parameters": {
    "uMin": 0,
    "uMax": 6.29,
    "vMin": 0,
    "vMax": 1,
    "uSegs": 150,
    "vSegs": 150
  },
  "extraParameters": [
    {
      "name": "t",
      "value": 2.05,
      "min": 0,
      "max": 8,
      "step": 0.01,
      "runtime": 8
    },
    {
      "name": "petalCount",
      "value": 8,
      "min": 1,
      "max": 24,
      "step": 1,
      "runtime": 8
    },
    {
      "name": "petalSharpness",
      "value": 3,
      "min": 0.5,
      "max": 10,
      "step": 0.1,
      "runtime": 8
    },
    {
      "name": "petalThickness",
      "value": 0.28,
      "min": 0,
      "max": 1,
      "step": 0.01,
      "runtime": 8
    },
    {
      "name": "innerRadius",
      "value": 0.08,
      "min": 0,
      "max": 0.5,
      "step": 0.01,
      "runtime": 8
    },
    {
      "name": "outerRadius",
      "value": 1,
      "min": 0.2,
      "max": 2,
      "step": 0.01,
      "runtime": 8
    },
    {
      "name": "twistStrength",
      "value": 1,
      "min": 0,
      "max": 4,
      "step": 0.01,
      "runtime": 8
    },
    {
      "name": "curlStrength",
      "value": 0.8,
      "min": 0,
      "max": 3,
      "step": 0.01,
      "runtime": 8
    },
    {
      "name": "wobbleAmount",
      "value": 0.12,
      "min": 0,
      "max": 0.5,
      "step": 0.001,
      "runtime": 8
    },
    {
      "name": "noiseScale",
      "value": 3,
      "min": 0.1,
      "max": 10,
      "step": 0.1,
      "runtime": 8
    },
    {
      "name": "bloomSpeed",
      "value": 0.9,
      "min": 0.1,
      "max": 3,
      "step": 0.01,
      "runtime": 8
    },
    {
      "name": "breathingAmount",
      "value": 0.05,
      "min": 0,
      "max": 0.2,
      "step": 0.001,
      "runtime": 8
    },
    {
      "name": "swayAmount",
      "value": 0.2,
      "min": 0,
      "max": 1,
      "step": 0.01,
      "runtime": 8
    },
    {
      "name": "centerHue",
      "value": 0.12,
      "min": 0,
      "max": 1,
      "step": 0.001,
      "runtime": 8
    },
    {
      "name": "petalHue",
      "value": 0.92,
      "min": 0,
      "max": 1,
      "step": 0.001,
      "runtime": 8
    },
    {
      "name": "edgeHueShift",
      "value": 0.06,
      "min": -0.2,
      "max": 0.2,
      "step": 0.001,
      "runtime": 8
    },
    {
      "name": "baseSaturation",
      "value": 0.85,
      "min": 0,
      "max": 1,
      "step": 0.001,
      "runtime": 8
    },
    {
      "name": "tipSaturation",
      "value": 1,
      "min": 0,
      "max": 1,
      "step": 0.001,
      "runtime": 8
    },
    {
      "name": "baseLightness",
      "value": 0.55,
      "min": 0,
      "max": 1,
      "step": 0.001,
      "runtime": 8
    },
    {
      "name": "tipLightness",
      "value": 0.82,
      "min": 0,
      "max": 1,
      "step": 0.001,
      "runtime": 8
    }
  ],
  "surface": {
    "code": "function surface(input) {\n    const u = input.u;          // angular parameter\n    const v = input.v;          // radial / petal-depth parameter\n    const t = input.t || 0.0;   // time\n\n    // Shape controls\n    const petalCount      = input.petalCount      || 8.0;\n    const petalSharpness  = input.petalSharpness  || 3.0;\n    const petalThickness  = input.petalThickness  || 0.28;\n    const innerRadius     = input.innerRadius     || 0.08;\n    const outerRadius     = input.outerRadius     || 1.0;\n    const twistStrength   = input.twistStrength   || 1.0;\n    const curlStrength    = input.curlStrength    || 0.8;\n    const wobbleAmount    = input.wobbleAmount    || 0.12;\n    const noiseScale      = input.noiseScale      || 3.0;\n\n    // Bloom / animation controls\n    const bloomSpeed      = input.bloomSpeed      || 0.9;  // how fast it opens\n    const breathingAmount = input.breathingAmount || 0.05; // subtle pulsing\n    const swayAmount      = input.swayAmount      || 0.2;  // whole flower swaying\n\n    // Color controls (HSL-ish)\n    const centerHue       = input.centerHue       || 0.12; // warm center\n    const petalHue        = input.petalHue        || 0.92; // pink/purple petals\n    const edgeHueShift    = input.edgeHueShift    || 0.06; // hue shift toward tips\n    const baseSaturation  = input.baseSaturation  || 0.85;\n    const tipSaturation   = input.tipSaturation   || 1.0;\n    const baseLightness   = input.baseLightness   || 0.55;\n    const tipLightness    = input.tipLightness    || 0.82;\n\n    // Utility: clamp 0â€“1\n    function saturate(x) {\n        return Math.max(0, Math.min(1, x));\n    }\n\n    // Utility: simple hash-based pseudo noise from 2D\n    function hash2(x, y) {\n        const s = Math.sin(x * 127.1 + y * 311.7) * 43758.5453;\n        return s - Math.floor(s);\n    }\n\n    // Utility: HSL -> RGB (h,s,l in [0,1])\n    function hslToRgb(h, s, l) {\n        h = ((h % 1) + 1) % 1; // wrap hue\n        function hue2rgb(p, q, t) {\n            t = ((t % 1) + 1) % 1;\n            if (t < 1/6) return p + (q - p) * 6 * t;\n            if (t < 1/2) return q;\n            if (t < 2/3) return p + (q - p) * (2/3 - t) * 6;\n            return p;\n        }\n        let r, g, b;\n        if (s === 0) {\n            r = g = b = l;\n        } else {\n            const q = l < 0.5 ? l * (1 + s) : l + s - l * s;\n            const p = 2 * l - q;\n            r = hue2rgb(p, q, h + 1/3);\n            g = hue2rgb(p, q, h);\n            b = hue2rgb(p, q, h - 1/3);\n        }\n        return { r, g, b };\n    }\n\n    // Normalize v to [0,1] thought of as \"distance from center\" along petal\n    const rad = saturate(v);\n\n    // Time-based bloom factor: starts closed (0) and eases to 1\n    const bloom = saturate(1.0 - Math.exp(-t * bloomSpeed));\n\n    // Subtle breathing / pulsation over time\n    const breathing = 1.0 + breathingAmount * Math.sin(t * 2.0 + rad * 3.0);\n\n    // Angle around the flower\n    const angle = u * petalCount; // wrap u around petalCount lobes\n\n    // Petal profile (0 at gaps, 1 along petal center)\n    const petalMask = Math.pow(saturate(Math.cos(angle * 0.5)), petalSharpness);\n\n    // Make petals thinner toward their tips\n    const thicknessProfile = 1.0 - Math.pow(rad, 1.5);\n\n    // Base radial extent of the petal\n    const baseR = innerRadius + (outerRadius - innerRadius) * rad;\n\n    // Twisting of petals as they open\n    const twist = twistStrength * bloom * rad;\n\n    // A bit of noisy waviness on edges\n    const edgeNoise = (hash2(u * noiseScale, v * noiseScale) - 0.5) * wobbleAmount;\n\n    // Final radial distance from the center\n    const petalRadius = baseR * (1.0 + petalMask * petalThickness * thicknessProfile) * breathing;\n    const finalAngle = u + twist * petalMask;\n\n    // Vertical shape: petals start upright and lay down as they bloom\n    const closedTilt = 1.0 - rad;                // upright near tip when closed\n    const openTilt   = 0.2 * (1.0 - rad);        // flatter when open\n    const tilt = (1.0 - bloom) * closedTilt + bloom * openTilt;\n\n    // Swaying the whole flower (like a gentle wind)\n    const swayX = swayAmount * Math.sin(t * 0.7);\n    const swayY = swayAmount * Math.cos(t * 0.9);\n\n    // Position\n    let x = (petalRadius + edgeNoise) * Math.cos(finalAngle);\n    let y = (petalRadius + edgeNoise) * Math.sin(finalAngle);\n    let z = curlStrength * petalMask * tilt + 0.1 * (1.0 - rad);\n\n    // Apply sway\n    x += swayX * (1.0 - rad);\n    y += swayY * (1.0 - rad);\n\n    // Add a small spherical center bulge\n    const centerRegion = saturate(1.0 - rad * 6.0);\n    const centerBulge = centerRegion * 0.25;\n    z += centerBulge;\n    x *= 1.0 + centerRegion * 0.1;\n    y *= 1.0 + centerRegion * 0.1;\n\n    // Color:\n    // Center is warm, petals are cooler; hue/lightness shift along rad & bloom\n    const centerMix = centerRegion;\n    const petalMix  = 1.0 - centerMix;\n\n    const hue = centerHue * centerMix\n              + (petalHue + edgeHueShift * Math.pow(rad, 1.5)) * petalMix;\n\n    const sat = baseSaturation * centerMix\n              + (tipSaturation - baseSaturation) * petalMix * (0.5 + 0.5 * bloom);\n\n    const light = baseLightness * centerMix\n                + tipLightness  * petalMix * (0.6 + 0.4 * bloom);\n\n    const rgb = hslToRgb(hue, saturate(sat), saturate(light));\n\n    // Slight darker veins along petalMask ridges\n    const vein = 0.25 * petalMask * (0.4 + 0.6 * bloom) * (1.0 - rad);\n    const rCol = saturate(rgb.r + vein * 0.4);\n    const gCol = saturate(rgb.g - vein * 0.1);\n    const bCol = saturate(rgb.b - vein * 0.2);\n\n    // Transparency: petals fade toward edges and when almost closed\n    const alpha = saturate(0.9 * (0.3 + 0.7 * bloom) * (0.4 + 0.6 * petalMask));\n\n    return {\n        x: x,\n        y: y,\n        z: z,\n        r: rCol,\n        g: gCol,\n        b: bCol,\n        a: alpha\n    };\n}\n"
  },
  "outputs": {
    "coordConversion": "none",
    "rgbToHsv": false
  }
}